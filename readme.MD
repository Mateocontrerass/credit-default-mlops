# Credit Default Prediction API ğŸ§ ğŸ’³

This project is an end-to-end machine learning system to predict whether a customer will default on a credit payment. It includes a FastAPI-based prediction service, a Gradio web UI, automatic logging to BigQuery, and CI/CD with GitHub Actions. The entire system is containerized and deployable on Google Cloud Run.

---

## ğŸš€ Features

- **Prediction API** built with FastAPI
- **Gradio Web UI** for interactive input
- **Prediction logging** directly to BigQuery
- **CI pipeline** with formatting, linting, and tests
- **Dockerized** for reproducibility
- **Cloud Run** deployment on GCP

---

## ğŸ§ª How it works

### ğŸ”— API Endpoint

- **POST** `/predict`
- **Input (JSON)**

```json
{
  "RevolvingUtilizationOfUnsecuredLines": 0.766,
  "age": 45,
  "NumberOfTime30_59DaysPastDueNotWorse": 2,
  "DebtRatio": 0.802,
  "MonthlyIncome": 5000,
  "NumberOfOpenCreditLinesAndLoans": 13,
  "NumberOfTimes90DaysLate": 0,
  "NumberRealEstateLoansOrLines": 6,
  "NumberOfTime60_89DaysPastDueNotWorse": 0,
  "NumberOfDependents": 2
}
```

- **Output**

```json
{
  "prediction": 0
}
```

- **GET** `/gradio`  
  Launches the Gradio UI for form-based prediction.

---

## ğŸ› ï¸ Setup & Development

### ğŸ“¦ Install

```bash
git clone https://github.com/your-username/credit-default-api.git
cd credit-default-api
make install  # Or use `pip install -r requirements.txt`
```

### ğŸš€ Run Locally

```bash
make run
# Or manually:
# uvicorn app.main:app --reload --port 8000
```

Access:
- API: http://localhost:8000/predict
- Gradio UI: http://localhost:8000/gradio

---

## âœ… Tests & Linting

```bash
make lint       # Run black formatting check
make test       # Run pytest
```

---

## â˜ï¸ Cloud Deployment (GCP)

- Fully deployed using Google Cloud Run
- Logs predictions to BigQuery (`credit_model_logs.prediction_logs`)
- Docker image built via GitHub Actions CI pipeline

---

## ğŸ“ Project Structure

```
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py              # FastAPI app
â”‚   â”œâ”€â”€ model.py             # Pydantic schema
â”‚   â”œâ”€â”€ predict.py           # Prediction logic
â”‚   â””â”€â”€ gradio_ui.py         # Gradio UI
â”œâ”€â”€ models/                  # Trained ML model (pickle)
â”œâ”€â”€ .github/workflows/ci.yml# CI Pipeline
â”œâ”€â”€ Dockerfile               # Docker for Cloud Run
â”œâ”€â”€ Makefile                 # Automation commands
â”œâ”€â”€ requirements.txt         # Python dependencies
â””â”€â”€ README.md
```

---

## Author

Mateo Contreras â€“ [LinkedIn](https://www.linkedin.com/in/mateo-contreras-data)

---

## License

MIT â€“ feel free to use, modify, and deploy.
